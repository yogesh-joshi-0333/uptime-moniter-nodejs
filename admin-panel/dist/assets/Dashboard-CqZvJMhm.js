import{c as t,s as e}from"./index-BWaFKzkF.js";import{u as s}from"./logs-DBJRUo48.js";import{_ as a,a as i,b as l}from"./StatusTimeline-BTFX7PAb.js";import{C as r,A as d,p as o,a as n,D as c}from"./charts-BUpwOSly.js";import{f as g,g as u,z as m,k as p,c as x,x as v,q as y,P as h,o as b,r as f,a as w,B as k,D as _,F as S,l as D,y as j,m as W}from"./vendor-CszhsB1H.js";import{_ as M}from"./LoadingSpinner-BAJStyFw.js";const T={class:"absolute inset-0 flex flex-col items-center justify-center"},U={class:"text-3xl font-bold text-gray-900 dark:text-white"},L={__name:"UptimeChart",props:{uptime:{type:Number,default:100},size:{type:Number,default:200}},setup(t){r.register(d,o,n);const e=t,s=x(()=>({labels:["Uptime","Downtime"],datasets:[{data:[e.uptime,100-e.uptime],backgroundColor:["#22c55e","#ef4444"],borderWidth:0,cutout:"75%"}]})),a={responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.9)",callbacks:{label:t=>`${t.label}: ${t.parsed.toFixed(2)}%`}}}};return(e,i)=>(u(),g("div",{class:"relative",style:h({width:`${t.size}px`,height:`${t.size}px`})},[m(v(c),{data:s.value,options:a},null,8,["data"]),p("div",T,[p("span",U,y(t.uptime.toFixed(1))+"%",1),i[0]||(i[0]=p("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Uptime",-1))])],4))}},$={class:"space-y-6"},z={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},R={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},A={class:"lg:col-span-2 card"},C={class:"card-body"},N={class:"card"},F={class:"card-body flex flex-col items-center justify-center"},I={class:"mt-4 text-center"},O={class:"text-lg font-semibold text-gray-900 dark:text-white"},P={class:"card"},q={class:"card-body"},B={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},E={class:"card"},V={class:"card-header flex items-center justify-between"},G={class:"divide-y divide-gray-200 dark:divide-gray-700"},H={key:0,class:"p-6"},J={class:"flex items-center gap-3 min-w-0"},K={class:"text-sm font-medium text-gray-900 dark:text-white truncate max-w-[200px]"},Q={class:"flex items-center gap-4 text-sm"},X={class:"text-gray-500 dark:text-gray-400"},Y={class:"text-gray-400 dark:text-gray-500 text-xs"},Z={key:2,class:"p-6 text-center text-gray-500 dark:text-gray-400"},tt={class:"card"},et={class:"card-header flex items-center justify-between"},st={class:"divide-y divide-gray-200 dark:divide-gray-700"},at={key:0,class:"p-6"},it={class:"flex items-center gap-3 min-w-0"},lt={class:"min-w-0"},rt={class:"text-sm font-medium text-gray-900 dark:text-white truncate max-w-[200px]"},dt={class:"text-xs text-gray-500 dark:text-gray-400"},ot={key:2,class:"p-6 text-center text-gray-500 dark:text-gray-400"},nt={__name:"Dashboard",setup(r){const d=t(),o=s(),n=f(!0),c=x(()=>{if(!o.logs.length)return 0;const t=o.logs.reduce((t,e)=>t+(e.response_time_ms||0),0);return Math.round(t/o.logs.length)}),h=x(()=>{if(!o.logs.length)return 100;return o.logs.filter(t=>"up"===t.status).length/o.logs.length*100}),T=x(()=>{const t=(new Date).toISOString().split("T")[0];return o.logs.filter(e=>{var s;return null==(s=e.checked_at)?void 0:s.startsWith(t)}).length}),U=x(()=>{const t=[],e=new Date;for(let s=29;s>=0;s--){const a=new Date(e);a.setDate(a.getDate()-s),t.push({date:a.toISOString().split("T")[0],status:Math.random()>.1?"up":"down",uptime:95+5*Math.random(),incidents:Math.random()>.9?Math.floor(3*Math.random())+1:0})}return t}),nt=x(()=>o.logs.slice(0,100).reverse().map((t,e)=>({time:new Date(t.checked_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),value:t.response_time_ms||0})));let ct=null;return b(async()=>{n.value=!0,await Promise.all([d.fetchWebsites(),o.fetchLogs()]),n.value=!1,ct=e.on("log",t=>{o.addRealtimeLog(t),d.updateWebsiteStatus(t.websiteId,t.status)})}),w(()=>{ct&&ct()}),(t,e)=>{const s=_("router-link");return u(),g("div",$,[p("div",z,[m(a,{title:"Total Websites",value:v(d).totalWebsites,icon:"websites",color:"primary",loading:n.value},null,8,["value","loading"]),m(a,{title:"Sites Up",value:v(d).upWebsites,icon:"up",color:"success",loading:n.value},null,8,["value","loading"]),m(a,{title:"Sites Down",value:v(d).downWebsites,icon:"down",color:"danger",loading:n.value},null,8,["value","loading"]),m(a,{title:"Avg Response",value:`${c.value} ms`,icon:"response",color:"warning",loading:n.value},null,8,["value","loading"])]),p("div",R,[p("div",A,[e[0]||(e[0]=p("div",{class:"card-header"},[p("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Response Time")],-1)),p("div",C,[m(i,{data:nt.value,height:300},null,8,["data"])])]),p("div",N,[e[2]||(e[2]=p("div",{class:"card-header"},[p("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Overall Uptime")],-1)),p("div",F,[m(L,{uptime:h.value,size:200},null,8,["uptime"]),p("div",I,[e[1]||(e[1]=p("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Last 24 hours",-1)),p("p",O,y(T.value)+" checks",1)])])])]),p("div",P,[e[3]||(e[3]=p("div",{class:"card-header"},[p("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"30-Day Status")],-1)),p("div",q,[m(l,{data:U.value,days:30},null,8,["data"])])]),p("div",B,[p("div",E,[p("div",V,[e[5]||(e[5]=p("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Recent Activity",-1)),m(s,{to:"/logs",class:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400"},{default:k(()=>[...e[4]||(e[4]=[j(" View all ",-1)])]),_:1})]),p("div",G,[n.value?(u(),g("div",H,[m(M)])):v(o).logs.length?(u(!0),g(S,{key:1},D(v(o).logs.slice(0,8),t=>{return u(),g("div",{key:t.id,class:"px-6 py-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[p("div",J,[p("span",{class:W(["status-dot","up"===t.status?"status-dot-up":"status-dot-down"])},null,2),p("span",K,y(t.url||`Website #${t.website_id}`),1)]),p("div",Q,[p("span",X,y(t.response_time_ms||0)+"ms",1),p("span",Y,y((e=t.checked_at,e?new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-")),1)])]);var e}),128)):(u(),g("div",Z," No recent activity "))])]),p("div",tt,[p("div",et,[e[7]||(e[7]=p("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Websites Status",-1)),m(s,{to:"/websites",class:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400"},{default:k(()=>[...e[6]||(e[6]=[j(" Manage ",-1)])]),_:1})]),p("div",st,[n.value?(u(),g("div",at,[m(M)])):v(d).websites.length?(u(!0),g(S,{key:1},D(v(d).websites.slice(0,8),t=>(u(),g("div",{key:t.id,class:"px-6 py-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[p("div",it,[p("span",{class:W(["status-dot","down"===t.lastStatus?"status-dot-down":"status-dot-up"])},null,2),p("div",lt,[p("p",rt,y(t.url),1),p("p",dt," Every "+y(t.interval_seconds)+"s ",1)])]),p("span",{class:W(["badge","down"===t.lastStatus?"badge-danger":"badge-success"])},y(t.lastStatus||"pending"),3)]))),128)):(u(),g("div",ot," No websites configured "))])])])])}}};export{nt as default};
