import{o as e,r as t,c as a,e as s,a as l,f as r,k as i,q as n,m as d,z as u,F as o,B as c,D as v,l as g,u as x,g as p,y as m,p as h}from"./vendor-CszhsB1H.js";import{c as y,a as k,s as f}from"./index-BWaFKzkF.js";import{u as w}from"./logs-DBJRUo48.js";import{_ as b,a as _,b as D}from"./StatusTimeline-BTFX7PAb.js";import{_ as S}from"./LoadingSpinner-BAJStyFw.js";import"./charts-BUpwOSly.js";const j={class:"space-y-6"},I={class:"flex items-center gap-4"},L={class:"flex-1 min-w-0"},C={class:"text-2xl font-bold text-gray-900 dark:text-white truncate"},T={class:"text-sm text-gray-500 dark:text-gray-400 truncate"},R={class:"flex items-center gap-2"},W={key:0,class:"card p-12"},$={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},B={class:"card"},O={class:"card-body"},U={class:"card"},z={class:"card-body"},F={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},M={class:"card"},q={class:"card-body space-y-4"},A={class:"text-gray-900 dark:text-white break-all"},E={class:"text-gray-900 dark:text-white"},H={class:"text-gray-900 dark:text-white"},N={class:"text-gray-900 dark:text-white"},V={class:"lg:col-span-2 card"},G={class:"card-header flex items-center justify-between"},J={class:"divide-y divide-gray-200 dark:divide-gray-700 max-h-96 overflow-y-auto"},K={class:"flex items-center gap-3"},P={class:"text-sm text-gray-900 dark:text-white"},Q={key:0,class:"text-danger-500"},X={class:"text-xs text-gray-500 dark:text-gray-400"},Y={class:"text-sm text-gray-700 dark:text-gray-300"},Z={__name:"WebsiteDetail",setup(Z){const ee=x(),te=s(),ae=y(),se=w(),le=k(),re=a(()=>parseInt(ee.params.id)),ie=t(null),ne=t(!0),de=t([]),ue=a(()=>{if(!de.value.length)return 100;return(de.value.filter(e=>"up"===e.status).length/de.value.length*100).toFixed(2)}),oe=a(()=>{if(!de.value.length)return 0;const e=de.value.reduce((e,t)=>e+(t.response_time_ms||0),0);return Math.round(e/de.value.length)}),ce=a(()=>{const e=de.value.find(e=>"down"===e.status);return e?new Date(e.checked_at).toLocaleString():"Never"}),ve=a(()=>de.value.slice(0,100).reverse().map(e=>({time:new Date(e.checked_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),value:e.response_time_ms||0}))),ge=a(()=>{const e=[],t=new Date;for(let a=29;a>=0;a--){const s=new Date(t);s.setDate(s.getDate()-a);const l=s.toISOString().split("T")[0],r=de.value.filter(e=>{var t;return null==(t=e.checked_at)?void 0:t.startsWith(l)}),i=r.filter(e=>"up"===e.status).length,n=r.length?i/r.length*100:null;e.push({date:l,status:null===n?"unknown":n>=99?"up":"down",uptime:n,incidents:r.filter(e=>"down"===e.status).length})}return e});let xe=null;function pe(e){return e?new Date(e).toLocaleString():"-"}function me(){te.push("/websites")}return e(async()=>{ne.value=!0;const e=await ae.getWebsiteById(re.value);if(!e.success)return le.error("Website not found"),void te.push("/websites");ie.value=e.data,await se.fetchLogs({websiteId:re.value}),de.value=se.logs,ne.value=!1,xe=f.on("log",e=>{e.websiteId===re.value&&(de.value.unshift(e),de.value.length>1e3&&(de.value=de.value.slice(0,1e3)))})}),l(()=>{xe&&xe()}),(e,t)=>{var a,s,l,x,y,k,f,w,Z;const ee=v("router-link");return p(),r("div",j,[i("div",I,[i("button",{onClick:me,class:"btn-icon"},[...t[0]||(t[0]=[i("svg",{class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),i("div",L,[i("h1",C,n((null==(a=ie.value)?void 0:a.name)||(null==(s=ie.value)?void 0:s.url)||"Loading..."),1),i("p",T,n(null==(l=ie.value)?void 0:l.url),1)]),i("div",R,[i("span",{class:d(["badge","down"===(null==(x=ie.value)?void 0:x.lastStatus)?"badge-danger":"badge-success"])},n((null==(y=ie.value)?void 0:y.lastStatus)||"pending"),3)])]),ne.value?(p(),r("div",W,[u(S,{size:"lg"})])):(p(),r(o,{key:1},[i("div",$,[u(b,{title:"Uptime",value:`${ue.value}%`,icon:"up",color:"success"},null,8,["value"]),u(b,{title:"Avg Response",value:`${oe.value} ms`,icon:"response",color:"primary"},null,8,["value"]),u(b,{title:"Total Checks",value:de.value.length,icon:"checks",color:"warning"},null,8,["value"]),u(b,{title:"Check Interval",value:`${null==(k=ie.value)?void 0:k.interval_seconds}s`,icon:"websites",color:"primary"},null,8,["value"])]),i("div",B,[t[1]||(t[1]=i("div",{class:"card-header"},[i("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Response Time History")],-1)),i("div",O,[u(_,{data:ve.value,height:300},null,8,["data"])])]),i("div",U,[t[2]||(t[2]=i("div",{class:"card-header"},[i("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"30-Day Status")],-1)),i("div",z,[u(D,{data:ge.value,days:30},null,8,["data"])])]),i("div",F,[i("div",M,[t[7]||(t[7]=i("div",{class:"card-header"},[i("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Details")],-1)),i("div",q,[i("div",null,[t[3]||(t[3]=i("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"URL",-1)),i("p",A,n(null==(f=ie.value)?void 0:f.url),1)]),i("div",null,[t[4]||(t[4]=i("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"Check Interval",-1)),i("p",E,"Every "+n(null==(w=ie.value)?void 0:w.interval_seconds)+" seconds",1)]),i("div",null,[t[5]||(t[5]=i("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"Created",-1)),i("p",H,n(pe(null==(Z=ie.value)?void 0:Z.created_at)),1)]),i("div",null,[t[6]||(t[6]=i("label",{class:"text-sm text-gray-500 dark:text-gray-400"},"Last Downtime",-1)),i("p",N,n(ce.value),1)])])]),i("div",V,[i("div",G,[t[9]||(t[9]=i("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Recent Checks",-1)),u(ee,{to:`/logs?websiteId=${re.value}`,class:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400"},{default:c(()=>[...t[8]||(t[8]=[m(" View all ",-1)])]),_:1},8,["to"])]),i("div",J,[(p(!0),r(o,null,g(de.value.slice(0,20),e=>(p(),r("div",{key:e.id,class:"px-6 py-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/50"},[i("div",K,[i("span",{class:d(["status-dot","up"===e.status?"status-dot-up":"status-dot-down"])},null,2),i("div",null,[i("p",P,[m(n("up"===e.status?"Online":"Offline")+" ",1),e.error_reason?(p(),r("span",Q," - "+n(e.error_reason),1)):h("",!0)]),i("p",X,n(pe(e.checked_at)),1)])]),i("span",Y,n(e.response_time_ms||0)+" ms",1)]))),128))])])])],64))])}}};export{Z as default};
